# LDAP/keycloakグループ同期

## 概要

LDAPとkeycloakのグループ同期とは、LDAPやKeycloakがもつ外部グループ情報を同期する機能です。

#### 利便性の向上

ユーザーの所属グループ情報が一貫して管理できるため、ユーザーやグループを再登録する必要がなく、手軽にグループ機能を活用できます。


#### セキュアな認証

外部認証プロバイダー（LDAPやKeycloak）が提供するセキュリティ機能を活用することで、認証や認可の信頼性が向上します。

## GROWI 側の必要な設定

1. 作成したい外部グループ（LDAPまたはKeycloak）のタブを選択します
2. 選択した認証機構の設定をします

- 外部グループ同期の機能を使うには、LDAP/keycloak の認証機構設定が必要です

### LDAP

GROWI 管理画面のセキュリティ設定画面(/admin/security)にアクセスし、「認証機構設定」内、「LDAP」タブから設定します。

- 設定内容1や手順の詳細は、 [LDAP連携](/ja/admin-guide/management-cookbook/ldap.html)をご覧ください。

GROWI 管理画面のグループ管理画面(/admin/user-groups)にアクセスし、「外部グループ管理」の「LDAP」タブから設定します。

- グループ検索ベース DN
- 所属メンバーを表す LDAP 属性
- 子グループを表す LDAP 属性

### Keycloak

 GROWI 管理画面のセキュリティ設定画面(/admin/security)にアクセスし、「認証機構設定」内、「OIDC」タブから設定します。

- プロバイダ名
- 発行ホスト
- クライアントID
- クライアントシークレット
- 認可エンドポイント
- トークンエンドポイント
- 失効エンドポイント
- 検証エンドポイント
- ユーザ情報エンドポイント
- セッション終了エンドポイント
- 登録エンドポイント
- Attribute Mapping
  - Identifier
  - username
  - Email

GROWI 管理画面のグループ管理画面(/admin/user-groups)にアクセスし、「外部グループ管理」の「Keycloak」タブから設定します。

- Host
- Group Realm
- Admin API にリクエストするための client がある realm
- Client の ID
- Client の Secret
- 作成されていない GROWI アカウントを自動生成する
- 説明

3. 同期実行の「同期」をクリックし、外部グループ管理内のグループ一覧にグループが追加されていることを確認します

 (TBD) 大規模グループの同期を実行すると、完了までに時間を要する場合がございます。  
※同期中にページ遷移しても問題ありません

4. 同期されたユーザでログインし、グループに所属していることを確認してください

