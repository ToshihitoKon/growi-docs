# LDAP/keycloakグループ同期

## 概要

LDAPとkeycloakのグループ同期とは、LDAPやKeycloakがもつ外部グループ情報を同期する機能です。

#### 利便性の向上

ユーザーの所属グループ情報が一貫して管理できるため、ユーザーやグループを再登録する必要がなく、手軽にグループ機能を活用できます。


#### セキュアな認証

外部認証プロバイダー（LDAPやKeycloak）が提供するセキュリティ機能を活用することで、認証や認可の信頼性が向上します。

## GROWI 側の必要な設定

- まず、作成したい外部グループ（LDAPまたはKeycloak）のタブを選択します
- 次に、選択した認証機構の設定をします

#### LDAP

GROWI 管理画面のグループ管理画面(/admin/user-groups)にアクセスし、「LDAP グループ同期設定」から設定します。

- グループ検索ベース DN
- 所属メンバーを表す LDAP 属性
- 子グループを表す LDAP 属性

#### Keycloak

1. GROWI 管理画面のグループ管理画面(/admin/user-groups)にアクセスし、「OIDC」から設定します。

- プロバイダ名
- 発行ホスト
- クライアントID
- クライアントシークレット
- 認可エンドポイント
- トークンエンドポイント
- 失効エンドポイント
- 検証エンドポイント
- ユーザ情報エンドポイント
- セッション終了エンドポイント
- 登録エンドポイント
- Attribute Mapping
  - Identifier
  - username
  - Email

2. 管理者画面のグループ管理の Keycloak のタブで、以下の設定を入力します

- Host
- Group Realm
- Admin API にリクエストするための client がある realm
- Client の ID
- Client の Secret
- 作成されていない GROWI アカウントを自動生成する
- 説明


- 同期実行の「同期」をクリックし、外部グループ管理内のグループ一覧にグループが追加されていることを確認します
  - 大規模グループの同期を実行すると、時間を要する場合がございます
    - 時間はかかりますが、同期途中でページ遷移しても問題ありません

- 同期されたユーザでログインし、グループに所属していることを確認してください

